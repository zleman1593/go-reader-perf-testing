<!DOCTYPE html>
<html>
<head>
    <title>Go Reader Performance Benchmark Report</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .chart-container { margin-bottom: 40px; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        tr:nth-child(even) { background-color: #f9f9f9; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Go Reader Performance Benchmark Report</h1>
        <p>Benchmark ran on Mar 23, 2025 10:42:10</p>
        <p>Source file: /Users/zackleman/Downloads/obsidian.dmg</p>
        <p>Number of runs per configuration: 2</p>
        
        <h2>Performance Summary</h2>
        
        <div class="chart-container">
            <h3>Server Response Time (ms)</h3>
            <canvas id="serverTimingChart"></canvas>
        </div>
        
        <div class="chart-container">
            <h3>Client Download Time (ms)</h3>
            <canvas id="clientTimingChart"></canvas>
        </div>
        
        <div class="chart-container">
            <h3>Memory Usage (MiB)</h3>
            <canvas id="memoryChart"></canvas>
        </div>
        
        <div class="chart-container">
            <h3>System Calls</h3>
            <canvas id="syscallChart"></canvas>
        </div>
        
        <h2>Detailed Results</h2>
        <table id="resultsTable">
            <tr>
                <th>Execution Path</th>
                <th>Buffer Size</th>
                <th>Avg Server Time (ms)</th>
                <th>Std Dev Server</th>
                <th>Avg Client Time (ms)</th>
                <th>Std Dev Client</th>
                <th>Avg Memory (MiB)</th>
                <th>Max Memory (MiB)</th>
                <th>Avg Read Calls</th>
                <th>Avg Write Calls</th>
                <th>Avg Total Calls</th>
            </tr>
        </table>
    </div>
    
    <script>
    // Load the benchmark data
    const benchmarkData = {"config":{"SourceFile":"/Users/zackleman/Downloads/obsidian.dmg","Port":8082,"Runs":2,"BufferSizes":[1024,8192,65536,1048576],"OutputDirectory":"benchmark_results"},"rawResults":[{"executionPath":"NOBUFFER","bufferSize":0,"runId":1,"serverTiming":174,"clientTiming":183.094,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":6,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:38:35.195583-07:00"},{"executionPath":"NOBUFFER","bufferSize":0,"runId":2,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:38:40.433843-07:00"},{"executionPath":"BUFIOREADER","bufferSize":1024,"runId":1,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:38:59.56119-07:00"},{"executionPath":"BUFIOREADER","bufferSize":1024,"runId":2,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:39:18.685842-07:00"},{"executionPath":"BUFIOREADER","bufferSize":8192,"runId":1,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:39:37.804195-07:00"},{"executionPath":"BUFIOREADER","bufferSize":8192,"runId":2,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:39:56.915191-07:00"},{"executionPath":"BUFIOREADER","bufferSize":65536,"runId":1,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:40:16.061515-07:00"},{"executionPath":"BUFIOREADER","bufferSize":65536,"runId":2,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:40:35.206174-07:00"},{"executionPath":"BUFIOREADER","bufferSize":1048576,"runId":1,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:40:54.310092-07:00"},{"executionPath":"BUFIOREADER","bufferSize":1048576,"runId":2,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:41:13.428413-07:00"},{"executionPath":"PRELOAD","bufferSize":0,"runId":1,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:41:32.521539-07:00"},{"executionPath":"PRELOAD","bufferSize":0,"runId":2,"serverTiming":0,"clientTiming":0,"memoryUsage":{"allocMiB":0,"totalAlloc":0,"sysMiB":0,"numGC":0,"maxHeapMiB":0,"heapInUseMiB":0},"systemCalls":{"readCalls":0,"writeCalls":0,"totalCalls":0},"timestamp":"2025-03-23T10:41:51.643025-07:00"}],"aggregateData":{"BUFIOREADER_1024":{"executionPath":"BUFIOREADER","bufferSize":1024,"numRuns":2,"avgServerTime":0,"minServerTime":0,"maxServerTime":0,"stdDevServer":0,"avgClientTime":0,"minClientTime":0,"maxClientTime":0,"stdDevClient":0,"avgMemoryAlloc":0,"maxMemoryAlloc":0,"avgHeapInUse":0,"maxHeapInUse":0,"avgReadCalls":0,"avgWriteCalls":0,"avgTotalCalls":0,"maxTotalCalls":0},"BUFIOREADER_1048576":{"executionPath":"BUFIOREADER","bufferSize":1048576,"numRuns":2,"avgServerTime":0,"minServerTime":0,"maxServerTime":0,"stdDevServer":0,"avgClientTime":0,"minClientTime":0,"maxClientTime":0,"stdDevClient":0,"avgMemoryAlloc":0,"maxMemoryAlloc":0,"avgHeapInUse":0,"maxHeapInUse":0,"avgReadCalls":0,"avgWriteCalls":0,"avgTotalCalls":0,"maxTotalCalls":0},"BUFIOREADER_65536":{"executionPath":"BUFIOREADER","bufferSize":65536,"numRuns":2,"avgServerTime":0,"minServerTime":0,"maxServerTime":0,"stdDevServer":0,"avgClientTime":0,"minClientTime":0,"maxClientTime":0,"stdDevClient":0,"avgMemoryAlloc":0,"maxMemoryAlloc":0,"avgHeapInUse":0,"maxHeapInUse":0,"avgReadCalls":0,"avgWriteCalls":0,"avgTotalCalls":0,"maxTotalCalls":0},"BUFIOREADER_8192":{"executionPath":"BUFIOREADER","bufferSize":8192,"numRuns":2,"avgServerTime":0,"minServerTime":0,"maxServerTime":0,"stdDevServer":0,"avgClientTime":0,"minClientTime":0,"maxClientTime":0,"stdDevClient":0,"avgMemoryAlloc":0,"maxMemoryAlloc":0,"avgHeapInUse":0,"maxHeapInUse":0,"avgReadCalls":0,"avgWriteCalls":0,"avgTotalCalls":0,"maxTotalCalls":0},"NOBUFFER_0":{"executionPath":"NOBUFFER","bufferSize":0,"numRuns":2,"avgServerTime":87,"minServerTime":0,"maxServerTime":174,"stdDevServer":7569,"avgClientTime":91.547,"minClientTime":0,"maxClientTime":183.094,"stdDevClient":8380.85,"avgMemoryAlloc":0,"maxMemoryAlloc":0,"avgHeapInUse":0,"maxHeapInUse":0,"avgReadCalls":0,"avgWriteCalls":0,"avgTotalCalls":0,"maxTotalCalls":0},"PRELOAD_0":{"executionPath":"PRELOAD","bufferSize":0,"numRuns":2,"avgServerTime":0,"minServerTime":0,"maxServerTime":0,"stdDevServer":0,"avgClientTime":0,"minClientTime":0,"maxClientTime":0,"stdDevClient":0,"avgMemoryAlloc":0,"maxMemoryAlloc":0,"avgHeapInUse":0,"maxHeapInUse":0,"avgReadCalls":0,"avgWriteCalls":0,"avgTotalCalls":0,"maxTotalCalls":0}}};
    
    // Prepare data for charts
    const labels = [];
    const serverTimingData = [];
    const serverTimingError = [];
    const clientTimingData = [];
    const clientTimingError = [];
    const memoryData = [];
    const readCallsData = [];
    const writeCallsData = [];
    
    // Populate the table
    const table = document.getElementById('resultsTable');
    
    // Sort by execution path and buffer size
    const sortedKeys = Object.keys(benchmarkData.aggregateData).sort((a, b) => {
        const [execA, bufA] = a.split('_');
        const [execB, bufB] = b.split('_');
        
        if (execA !== execB) {
            // Order: NOBUFFER, BUFIOREADER, PRELOAD
            const order = { 'NOBUFFER': 1, 'BUFIOREADER': 2, 'PRELOAD': 3 };
            return order[execA] - order[execB];
        }
        
        return parseInt(bufA) - parseInt(bufB);
    });
    
    for (const key of sortedKeys) {
        const stats = benchmarkData.aggregateData[key];
        
        // Add to charts data
        let label = stats.executionPath;
        if (stats.executionPath === 'BUFIOREADER') {
            const bufferSizeStr = formatBufferSize(stats.bufferSize);
            label += ' (' + bufferSizeStr + ')';
        }
        labels.push(label);
        
        serverTimingData.push(stats.avgServerTime);
        serverTimingError.push(stats.stdDevServer);
        
        clientTimingData.push(stats.avgClientTime);
        clientTimingError.push(stats.stdDevClient);
        
        memoryData.push(stats.avgMemoryAlloc);
        readCallsData.push(stats.avgReadCalls);
        writeCallsData.push(stats.avgWriteCalls);
        
        // Add to table
        const row = table.insertRow(-1);
        row.insertCell(0).textContent = stats.executionPath;
        row.insertCell(1).textContent = stats.executionPath === 'BUFIOREADER' ? 
            formatBufferSize(stats.bufferSize) : '-';
        row.insertCell(2).textContent = stats.avgServerTime.toFixed(2);
        row.insertCell(3).textContent = stats.stdDevServer.toFixed(2);
        row.insertCell(4).textContent = stats.avgClientTime.toFixed(2);
        row.insertCell(5).textContent = stats.stdDevClient.toFixed(2);
        row.insertCell(6).textContent = stats.avgMemoryAlloc.toFixed(2);
        row.insertCell(7).textContent = stats.maxMemoryAlloc;
        row.insertCell(8).textContent = stats.avgReadCalls.toFixed(2);
        row.insertCell(9).textContent = stats.avgWriteCalls.toFixed(2);
        row.insertCell(10).textContent = stats.avgTotalCalls.toFixed(2);
    }
    
    // Helper function to format buffer sizes
    function formatBufferSize(bytes) {
        if (bytes < 1024) return bytes + ' B';
        if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
        if (bytes < 1024 * 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        return (bytes / (1024 * 1024 * 1024)).toFixed(1) + ' GB';
    }
    
    // Create charts
    const serverTimingChart = new Chart(
        document.getElementById('serverTimingChart'),
        {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Avg Server Response Time (ms)',
                    data: serverTimingData,
                    backgroundColor: 'rgba(54, 162, 235, 0.5)',
                    borderColor: 'rgb(54, 162, 235)',
                    borderWidth: 1,
                    errorBars: {
                        show: true,
                        color: 'red',
                        width: 2
                    },
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Time (ms)'
                        }
                    }
                }
            }
        }
    );
    
    const clientTimingChart = new Chart(
        document.getElementById('clientTimingChart'),
        {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Avg Client Download Time (ms)',
                    data: clientTimingData,
                    backgroundColor: 'rgba(255, 99, 132, 0.5)',
                    borderColor: 'rgb(255, 99, 132)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Time (ms)'
                        }
                    }
                }
            }
        }
    );
    
    const memoryChart = new Chart(
        document.getElementById('memoryChart'),
        {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Avg Memory Usage (MiB)',
                    data: memoryData,
                    backgroundColor: 'rgba(75, 192, 192, 0.5)',
                    borderColor: 'rgb(75, 192, 192)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Memory (MiB)'
                        }
                    }
                }
            }
        }
    );
    
    const syscallChart = new Chart(
        document.getElementById('syscallChart'),
        {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Avg Read Calls',
                        data: readCallsData,
                        backgroundColor: 'rgba(153, 102, 255, 0.5)',
                        borderColor: 'rgb(153, 102, 255)',
                        borderWidth: 1
                    },
                    {
                        label: 'Avg Write Calls',
                        data: writeCallsData,
                        backgroundColor: 'rgba(255, 159, 64, 0.5)',
                        borderColor: 'rgb(255, 159, 64)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Number of System Calls'
                        }
                    }
                }
            }
        }
    );
    </script>
</body>
</html>